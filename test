const https = require("https");

const AWS = require("aws-sdk");

module.exports = {

createHttpsRequestPromise: async function (

host,

path,

headers,

method,

requestData,

callback,

){

return new Promise((resolve, reject) => {

const options = {

host: host,

path: path,

rejectUnauthorized: false,

method: method,

headers: headers,

port: 443,

timeout: 300000,

};

const req = https.request (options, (res) => {

if (res.statusCode < 200 || res.statusCode >= 300) {

console.log("http response==> ", res);

return reject (new Error("statusCode=" + res.statusCode));

}

var body =[];

res.on("data", function (chunk) {

body.push(chunk);

});

res.on("end", function () {

try {

console.log("api response code is");

console.log(res.statusCode);

console.log("printing response body for test");

console.log (body);

body = JSON.parse(Buffer.concat(body).toString());

} catch (e) {

reject (e);

}

resolve (body);

});

});

req.on("error", (e) => {

reject (e.message);

});

if (requestData) req.write(requestData) ;
 // send the request

req.end();

});

},

};
